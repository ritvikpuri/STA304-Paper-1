---
title: "Toronto Apartment Evaluations"
subtitle: "Subtitle Here"
author: 
  - Ritvik Puri
  # - Another author
thanks: "Code and data are available at: www.github.com/ritvikpuri/sta304-paper-1"
date: "`r format(Sys.time(), '%d %B %Y')`"
abstract: "First sentence. Second sentence. Third sentence. Fourth sentence."
output:
  bookdown::pdf_document2
toc: FALSE
bibliography: references.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
# library(palmerpenguins)
library(opendatatoronto)
```

# Introduction

<!-- You can and should cross-reference sections and sub-sections. For instance, Section \@ref(data). R Markdown automatically makes the sections lower case and adds a dash to spaces to generate labels, for instance, Section \@ref(first-discussion-point).  -->

The city of Toronto introcued a new bylaw enformenent program in July 2017 that is used to ensure that the apartment building owners and operators comply with the neccesary building maintanence standards, known as RentSafeTO. These standards are applied to all apartment buildings with 10 or more units  or with 3 or more stories.

Owners of such apartments are required to register with RentSafeTO as well as mainitan the standards defined by this program. Tentants need to conatct their respective landlord incase they face an issue. These issues could either be vital, such as heat or hydro fault, or service requests, such as window flaws or common area cleaning.  If the landlord does not comply to these requests, then according to the bylaws of RentSafeTO program, legal action can be taken against them. 

Each property that falls under the program gets insepected by an officer and receives an evaluation score, which is made available to not only the landlord and tenant, but also to the potential tenants. If the score of a building is 86 or above, it will be evaluated again in the next three years. If it is between 66 and 85, it will be evaluated again within two years. If it is between 51 and 65, it will be evaluated again within a year. If a building gets a score of 50 or below, then then the full building will undergo a comprehensive inspection.

Home safety evaluations are neccesary to protect residents from potential hazards which may lead to personal injury if left unchecked. In a city like Toronto, where a lot of people do not own their personal property and live in rented apartments, it is critical that the landlord is kept informed of their building's condition so that they can ensure a tenants safety. Dhekte hein ki kuch badiya sa milta hai ya nahi inn socres ke baare mein. Aayie shuru karte, bina kisi rukawat ke.

I think we should see which factors have the most effect on the evaluation score.

# Data

<!-- Our data is of penguins (Figure \@ref(fig:bills)). -->

```{r}
	
package <- show_package("4ef82789-e038-44ef-a478-a8f3590c3eb1")
package
 
# get all resources for this package
resources <- list_package_resources("4ef82789-e038-44ef-a478-a8f3590c3eb1")
 
# identify datastore resources; by default, Toronto Open Data sets datastore resource format to CSV for non-geospatial and GeoJSON for geospatial resources
datastore_resources <- filter(resources, tolower(format) %in% c('csv', 'geojson'))
 
# load the first datastore resource as a sample
data <- filter(datastore_resources, row_number()==1) %>% get_resource()

sapply(data, class)
data[,1:5] <- sapply(data[,1:5], as.numeric)
data[,7:7] <- sapply(data[,7:7], as.numeric)
data[,10:11] <- sapply(data[,10:11], as.numeric)
data[,13:13] <- sapply(data[,13:13], as.numeric)
data[,14:35] <- sapply(data[,14:35], as.numeric)


view(data)
```


Talk more about it.

Also bills and their average (Figure \@ref(fig:billssssss)). (Notice how you can change the height and width so they don't take the whole page?)

```{r billssssss, fig.cap="More bills of penguins", echo = FALSE, fig.width=8, fig.height=4}

#unique proerty types
unique_properties <- unique(data$PROPERTY_TYPE)

data %>%
  ggplot(mapping = aes(x = SCORE, y = CONFIRMED_UNITS, color= WARDNAME)) + 
  geom_point(alpha = 0.5)

data %>%
  ggplot(mapping = aes(y = SCORE, fill=WARDNAME)) +
  geom_bar()

mut_data <- data %>%
  mutate(score_category =
           case_when(SCORE <= 50 ~ "<=50",
                     SCORE <= 65 ~ "51-65",
                     SCORE <= 85 ~ "66-85",
                     SCORE <= 100 ~ "86-100"),
         score_category = factor(score_category,
                                 levels = c("<=50",
                                            "51-65",
                                            "66-85",
                                            "86-100"
                                            )
                                 )
         )
view(mut_data)
mut_data %>%
  ggplot(mapping = aes(x = score_category, fill = PROPERTY_TYPE)) +
  geom_bar(position = "dodge")
```

We can see how there are a lot of apartment building with a score thats between 66 and 85, which means they wont be evaluated for the next 2 years and are consiered to be in good condition overall. But what makes the score of these buildings higher than the rest? And what do the few buildings with a score of more than 86 do that separtes them from the rest?



# Model

\begin{equation}
Pr(\theta | y) = \frac{Pr(y | \theta) Pr(\theta)}{Pr(y)}  (\#eq:bayes)
\end{equation}

Equation \@ref(eq:bayes) seems useful, eh?

Here's a dumb example of how to use some references: In paper we run our analysis in `R` [@citeR]. We also use the `tidyverse` which was written by @thereferencecanbewhatever If we were interested in baseball data then @citeLahman could be useful. 

We can use maths by including latex between dollar signs, for instance $\theta$.


# Results

# Discussion

## First discussion point

If my paper were 10 pages, then should be be at least 2.5 pages. The discussion is a chance to show off what you know and what you learnt from all this. 

## Second discussion point

## Third discussion point

## Weaknesses and next steps

Weaknesses and next steps should also be included.

\newpage

\appendix

# Appendix {-}


# Additional details


\newpage


# References
https://www.toronto.ca/community-people/housing-shelter/rental-housing-tenant-information/rental-housing-standards/apartment-building-standards/rentsafeto-for-tenants/

https://www.toronto.ca/community-people/housing-shelter/rental-housing-tenant-information/rental-housing-standards/apartment-building-standards/rentsafeto-for-building-owners/rentsafeto-building-evaluations-and-audits/

